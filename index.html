<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ“</text></svg>">
    
    <meta property="og:type" content="website">
    <meta property="og:title" content="ëª°ì…í˜• ì—ë””í„°">
    <meta property="og:description" content="ì „ì²´í™”ë©´ ì§‘í•„ í™˜ê²½ì„ ì œê³µí•˜ëŠ” ì—ë””í„°">
    <meta property="og:image" content="thumb.png">

    <title>ëª°ì…í˜• ì—ë””í„°</title>
    <style>
        /* 1. ì „ì²´ í™”ë©´ ë ˆì´ì•„ì›ƒ ì„¤ì • */
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif;
            background-color: #ffffff; /* ì¢…ì´ ì§ˆê°ì„ ìœ„í•´ ì™„ì „ í°ìƒ‰ í˜¹ì€ ë¯¸ìƒ‰ */
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden; /* ì „ì²´ ìŠ¤í¬ë¡¤ ë§‰ìŒ */
            position: relative;
        }

        /* 2. ì…ë ¥ì°½ (í™”ë©´ ê½‰ ì°¨ê²Œ) */
        textarea {
            width: 100%;
            height: 100%;
            border: none;
            resize: none;
            outline: none;
            
            /* ê³ í•´ìƒë„ ê°€ë…ì„± ì„¸íŒ… */
            font-size: 17px; 
            line-height: 1.8;
            color: #333;
            font-family: 'Pretendard', sans-serif;
            
            /* ì—¬ë°±: ìš°ì¸¡ ìƒë‹¨ íŒ¨ë„ì„ ê°€ë¦¬ì§€ ì•Šìœ¼ë©´ì„œ í¸ì•ˆí•˜ê²Œ */
            padding: 40px 50px; 
            box-sizing: border-box;
            
            overflow-y: auto; /* ë‚´ë¶€ ìŠ¤í¬ë¡¤ */
            background-color: transparent;
        }

        /* ìŠ¤í¬ë¡¤ë°” ë””ìì¸ (ìˆ¨ê¸°ê±°ë‚˜ ë¯¸ë‹ˆë©€í•˜ê²Œ) */
        textarea::-webkit-scrollbar { width: 8px; }
        textarea::-webkit-scrollbar-track { background: transparent; }
        textarea::-webkit-scrollbar-thumb { background: #e0e0e0; border-radius: 4px; }

        /* 3. ìš°ì¸¡ ìƒë‹¨ í”Œë¡œíŒ… íŒ¨ë„ (ìº¡ì…˜ ìŠ¤íƒ€ì¼) */
        .floating-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 240px; /* ì ì ˆí•œ í­ */
            
            /* ìœ ë¦¬ ì§ˆê° (Glassmorphism) íš¨ê³¼ */
            background-color: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            
            border: 1px solid rgba(0,0,0,0.05);
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            
            padding: 12px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 100;
            transition: opacity 0.3s;
        }

        /* ë§ˆìš°ìŠ¤ ì•ˆ ì˜¬ë¦¬ë©´ íë¦¬ê²Œ ì²˜ë¦¬í•´ì„œ ê¸€ì“°ê¸° ì§‘ì¤‘? (ì„ íƒì‚¬í•­) */
        /* .floating-panel:hover { opacity: 1; }
           .floating-panel { opacity: 0.6; } */

        /* ë²„íŠ¼ ì¤„ */
        .panel-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .btn-group {
            display: flex;
            gap: 4px;
        }

        .icon-btn {
            background: transparent;
            border: 1px solid transparent;
            cursor: pointer;
            padding: 6px;
            border-radius: 6px;
            color: #555;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .icon-btn:hover { background-color: rgba(0,0,0,0.05); color: #000; }
        .icon-btn:active { transform: translateY(1px); }
        .icon-btn svg { width: 18px; height: 18px; fill: currentColor; }

        /* êµ¬ë¶„ì„  */
        .sep { width: 1px; height: 14px; background: #ddd; margin: 0 2px; }

        /* í†µê³„ í…ìŠ¤íŠ¸ */
        .stats-info {
            font-size: 12px;
            color: #666;
            display: flex;
            flex-direction: column;
            gap: 4px;
            background-color: rgba(0,0,0,0.03);
            padding: 8px;
            border-radius: 8px;
        }
        
        .stat-line {
            display: flex;
            justify-content: space-between;
        }
        .stat-line strong { color: #333; }
        .token-text { color: #673ab7; }

        /* íŒŒì¼ ì…ë ¥ ìˆ¨ê¹€ */
        #fileInput { display: none; }

        /* í† ìŠ¤íŠ¸ ë©”ì‹œì§€ */
        .toast {
            visibility: hidden;
            min-width: 200px;
            background-color: rgba(40, 40, 40, 0.95);
            color: #fff;
            text-align: center;
            border-radius: 50px;
            padding: 12px 24px;
            position: fixed;
            z-index: 1000;
            left: 50%;
            bottom: 40px;
            transform: translateX(-50%);
            font-size: 14px;
            font-weight: 500;
            opacity: 0;
            transition: opacity 0.3s, bottom 0.3s;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .toast.show {
            visibility: visible;
            opacity: 1;
            bottom: 60px;
        }
    </style>
</head>
<body>

    <div class="floating-panel">
        
        <div class="panel-row">
            <div class="btn-group">
                <button class="icon-btn" id="btnSaveJson" title="ì €ì¥">
                    <svg viewBox="0 0 24 24"><path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/></svg>
                </button>
                <button class="icon-btn" id="btnLoadJson" title="ë¶ˆëŸ¬ì˜¤ê¸°">
                    <svg viewBox="0 0 24 24"><path d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V8h16v10z"/></svg>
                </button>
            </div>
            <div class="sep"></div>
            <div class="btn-group">
                <button class="icon-btn" id="btnUndo" title="ì·¨ì†Œ">
                    <svg viewBox="0 0 24 24"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"/></svg>
                </button>
                <button class="icon-btn" id="btnRedo" title="ë‹¤ì‹œ ì‹¤í–‰">
                    <svg viewBox="0 0 24 24"><path d="M18.4 10.6C16.55 9 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"/></svg>
                </button>
            </div>
            <div class="sep"></div>
            <div class="btn-group">
                <button class="icon-btn" id="btnCopy" title="ë³µì‚¬">
                    <svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
                </button>
                <button class="icon-btn" id="btnPaste" title="ë¶™ì—¬ë„£ê¸°">
                    <svg viewBox="0 0 24 24"><path d="M19 2h-4.18C14.4.84 13.3 0 12 0c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm7 18H5V4h2v3h10V4h2v16z"/></svg>
                </button>
            </div>
        </div>

        <div class="stats-info">
            <div class="stat-line">
                <span>AI í† í°</span>
                <strong id="totalToken" class="token-text">0</strong>
            </div>
            <div class="stat-line">
                <span>ê¸€ììˆ˜(ì „ì²´)</span>
                <strong id="totalChar">0</strong>
            </div>
            <div class="stat-line" id="selectionRow" style="display:none; color:#1565c0;">
                <span>ì„ íƒ ì˜ì—­</span>
                <strong id="selectChar">0</strong>
            </div>
        </div>
    </div>

    <input type="file" id="fileInput" accept=".json">

    <textarea id="textInput" placeholder="ì´ê³³ì— ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
    
    <div id="toast" class="toast">ë©”ì‹œì§€</div>

<script>
    const textInput = document.getElementById('textInput');
    const totalToken = document.getElementById('totalToken');
    const totalChar = document.getElementById('totalChar');
    const selectionRow = document.getElementById('selectionRow');
    const selectChar = document.getElementById('selectChar');
    const fileInput = document.getElementById('fileInput');
    const toast = document.getElementById('toast');

    const STORAGE_KEY = 'my_editor_content_v1';

    // === ê¸°ë³¸ ê¸°ëŠ¥ ë¡œì§ ===
    function showToast(message) {
        toast.textContent = message;
        toast.classList.add('show');
        setTimeout(() => toast.classList.remove('show'), 2500);
    }

    // íŒŒì¼ ì €ì¥
    document.getElementById('btnSaveJson').addEventListener('click', () => {
        if (!textInput.value) { showToast('ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.'); return; }
        const data = { content: textInput.value, savedAt: new Date().toLocaleString() };
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        const timestamp = new Date().toISOString().slice(0,19).replace(/[-T:]/g,"");
        a.download = `backup_${timestamp}.json`;
        document.body.appendChild(a); a.click(); document.body.removeChild(a);
        showToast('JSON íŒŒì¼ ì €ì¥ ì™„ë£Œ');
    });

    // íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
    document.getElementById('btnLoadJson').addEventListener('click', () => fileInput.click());
    fileInput.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (!file) return;
        if (textInput.value.trim().length > 0 && !confirm("í˜„ì¬ ë‚´ìš©ì´ ëŒ€ì²´ë©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
            fileInput.value = ''; return;
        }
        const reader = new FileReader();
        reader.onload = function(evt) {
            try {
                const data = JSON.parse(evt.target.result);
                if(data.content !== undefined) {
                    textInput.value = data.content;
                    updateCounts(); saveContent(false);
                    showToast('íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸° ì™„ë£Œ');
                } else alert('íŒŒì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
            } catch(err) { alert('íŒŒì¼ ì˜¤ë¥˜ ë°œìƒ'); }
        };
        reader.readAsText(file);
        fileInput.value = '';
    });

    // í¸ì§‘ ë²„íŠ¼ ì—°ê²°
    document.getElementById('btnUndo').addEventListener('click', () => { document.execCommand('undo'); textInput.focus(); });
    document.getElementById('btnRedo').addEventListener('click', () => { document.execCommand('redo'); textInput.focus(); });
    document.getElementById('btnCopy').addEventListener('click', () => {
        if (!textInput.value) return showToast('ë‚´ìš© ì—†ìŒ');
        navigator.clipboard.writeText(textInput.value).then(() => showToast('ë³µì‚¬ ì™„ë£Œ')).catch(()=>showToast('ë³µì‚¬ ì‹¤íŒ¨'));
    });
    document.getElementById('btnPaste').addEventListener('click', async () => {
        try {
            const text = await navigator.clipboard.readText();
            if(!text) return showToast('ë‚´ìš© ì—†ìŒ');
            const start = textInput.selectionStart;
            const original = textInput.value;
            textInput.value = original.slice(0, start) + text + original.slice(textInput.selectionEnd);
            textInput.selectionStart = textInput.selectionEnd = start + text.length;
            updateCounts(); textInput.focus(); showToast('ë¶™ì—¬ë„£ê¸° ì™„ë£Œ');
        } catch(e) { alert('Ctrl+Vë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.'); }
    });

    // ìë™ ì €ì¥ ë° ì¹´ìš´íŠ¸
    function saveContent(isAuto = false) {
        localStorage.setItem(STORAGE_KEY, textInput.value);
        if (isAuto) showToast('ìë™ ì €ì¥ë¨ (3ë¶„)');
    }

    function estimateTokens(text) {
        if (!text) return 0;
        const cjk = (text.match(/[\u3131-\uD79D\uAC00-\uD7A3\u4E00-\u9FFF]/g) || []).length;
        return Math.ceil((cjk * 1.1) + ((text.length - cjk) * 0.25));
    }

    function updateCounts() {
        const text = textInput.value;
        totalToken.textContent = estimateTokens(text).toLocaleString();
        totalChar.textContent = text.length.toLocaleString();
        
        const selStart = textInput.selectionStart;
        const selEnd = textInput.selectionEnd;
        if (selEnd > selStart) {
            selectionRow.style.display = 'flex';
            selectChar.textContent = (selEnd - selStart).toLocaleString();
        } else {
            selectionRow.style.display = 'none';
        }
    }

    // ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    window.addEventListener('load', () => {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (saved) { textInput.value = saved; updateCounts(); showToast('ë‚´ìš© ë³µêµ¬ë¨'); }
    });

    setInterval(() => { if(textInput.value) saveContent(true); }, 180000);
    window.addEventListener('beforeunload', () => saveContent(false));
    
    ['input', 'click', 'mouseup', 'keyup'].forEach(ev => textInput.addEventListener(ev, updateCounts));

</script>
</body>
</html>
